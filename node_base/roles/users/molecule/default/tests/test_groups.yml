---
- name: Check if groups exist
  ansible.builtin.group:
    name: "{{ item.name }}"
    system: "{{ item.system | default(false) }}"
  loop: "{{ users_groups }}"
  check_mode: true
  register: group_check

- name: Assert groups exist
  ansible.builtin.assert:
    that:
      - item.changed == false
    fail_msg: "Group {{ item.item.name }} does not match the expected state."
    success_msg: "Group {{ item.item.name }} exists."
  loop: "{{ group_check.results }}"
